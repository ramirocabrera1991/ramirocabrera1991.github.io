import{k as G,a as _,r as C,l as J,m as i,_ as K,o as Q,b as H,c as Z,n as j,d as w,e as S,f as I,g as l,q as A,F as O,h as P,u as L,s as ee,x as te,t as d,y as le,p as oe,j as ae}from"./index-i6v4TSru.js";import{N as ne}from"./NavBar-tk1zE2nK.js";function U(e){return typeof e=="boolean"}function W(e){return typeof e=="number"}function Y(e){return typeof e=="object"&&e!==null}const ie=G({props:{visible:[Object,Boolean],name:String,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},type:{type:String,default:""},modalClass:{type:String,default:"modal-vue3-wrap"},width:{type:[String,Number],default:500},offsetTop:{type:[String,Number],default:100},zIndex:{type:[String,Number],default:1e3},title:{type:String,default:"Title"},animation:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},draggable:{type:[Boolean,Object],default:!1},cancelButton:{type:Object,default:()=>({text:"cancel",onclick:null,loading:!1})},okButton:{type:Object,default:()=>({text:"ok",onclick:null,loading:!1})}},setup(e,{slots:y,emit:v}){let m;const r=e.name,$=typeof e.width=="string"?e.width:`${e.width}px`,N=typeof e.offsetTop=="string"?e.offsetTop:`${e.offsetTop}px`,V=_(null),g=_(null);let f=null,a=null,n=C({init:-15,value:-15,max:0,step:1,speed:10,linear:!1}),h=C({init:0,value:0,max:360,step:30,speed:30,linear:!0});const x=(t,u,p)=>{let E=u?t.max:t.init,k=u?t.init:t.max;if(u?t.value<=k:t.value>=k)return t.linear?t.value=E:(t.value=k,p&&p()),!1;setTimeout(()=>{u?t.value-=t.step:t.value+=t.step},t.speed)},o=t=>{t&&m.list.length>0&&Y(e.visible)?m.trigger(t,!1):v("update:visible",!1)},F=t=>{!e.maskClosable||!e.mask||t.target===V.value&&o(r)};let s=C({value:!1,target:""});const z=(t,u)=>{const p=t[u];(!p.loading||p.loading&&!s.value)&&(p.onclick&&typeof p.onclick=="function"?p.onclick():o(t.name),p.loading&&(s.value=!0,s.target=u))},c=_(),b=C({left:void 0,top:void 0}),T=t=>{t.preventDefault(),t.stopPropagation()},M=t=>{let u=g.value.offsetLeft,p=g.value.offsetTop,E={width:g.value.offsetWidth,height:g.value.offsetHeight,clientWidth:document.documentElement.clientWidth,clientHeight:document.documentElement.clientHeight,x:t.pageX-u,y:t.pageY-p};c.value=E,T(t);const k=B=>{if(!c.value)return;let R=B.pageX,X=B.pageY;b.left=Math.min(Math.max(R-c.value.x,0),c.value.clientWidth-c.value.width),b.top=Math.min(Math.max(X-c.value.y,0),c.value.clientHeight-c.value.height),T(B)},D=B=>{!c.value||(c.value=void 0,T(B),document.removeEventListener("pointermove",k),document.removeEventListener("pointerup",D))};document.addEventListener("pointermove",k),document.addEventListener("pointerup",D)};return J(()=>e.draggable,t=>{Y(t)&&t.addEventListener("pointerdown",M)}),()=>{if(y.default){let t;return U(e.visible)?t=e.visible:(t=e.visible.currVisible[r],m=e.visible.dep),t?(s.value&&x(h),e.animation===!1?n.value=n.max:(f!=r&&(f=r,n.value=n.init),n.speed=5,x(n)),n.value>=n.max&&!c.value&&a!=r&&(a=r,v("onVisible"))):(a==r||!r)&&(e.animation===!1?t=!1:(t=!0,n.speed=2,x(n,!0,()=>{t=!1,a=null,s.value=!1,v("onUnVisible")}))),t?i("div",{class:e.modalClass},[e.mask?i("div",{class:"modal-vue3-mask",style:`width:100%;height:100%;position:fixed;left:0;top:0;background-color:rgba(0, 0, 0, 0.25);z-index:${e.zIndex-1};`}):null,i("div",{ref:V,style:`position:fixed;left:0;right:0;top:0;bottom:0;margin: 0 auto;z-index:${e.zIndex};overflow:auto;outline:0;`,onclick:u=>{F(u)}},[i("div",{ref:g,class:"modal-vue3-content",style:`width:${$};position:relative;top:${W(b.top)?b.top+"px":N};left:${b.left?b.left+"px":""};margin: ${W(b.left)?"0":"0 auto"}; ${e.type!="clean"?"border:1px solid #f0f0f0;":""}overflow:auto;outline:0;box-sizing:border-box; ${e.type!="clean"?"background-color:#fff;":""}border-radius:2px;transform:translateY(${n.value}px);`},[e.type!="clean"?i("div",{class:"modal-vue3-header",style:`padding:12px 22px;border-bottom:1px solid #f0f0f0;position:relative;${e.draggable&&U(e.draggable)?"cursor:move;":""}`,onpointerdown:e.draggable&&U(e.draggable)?M:null},[i("div",null,e.title),e.closable?i("div",{style:"width:20px;height:16px;cursor:pointer;position:absolute;top:15px;right:15px;font-size: 20px;",onclick:()=>{o(r)}},[i("div",{style:"width:14px;height:1px;position:absolute;left:0;right:0;top:0;bottom:0;margin:auto;background-color:#999;transform:rotate(45deg);"},""),i("div",{style:"width:14px;height:1px;position:absolute;left:0;right:0;top:0;bottom:0;margin:auto;background-color:#999;transform:rotate(-45deg);"},"")]):null]):null,i("div",{class:"modal-vue3-body",style:e.type!="clean"?"padding: 14px 22px":""},y.default()),e.type!="clean"?i("div",{class:"modal-vue3-footer",style:"padding: 12px 22px;display:flex;justify-content:flex-end;align-items:center;border-top:1px solid #f0f0f0;"},[i("div",{class:"modal-vue3-footer-cancel",style:`margin-right: 20px;height:30px;padding:0 8px;border-radius:2px;border: 1px solid #d9d9d9;display:flex;justify-content:center;align-items:center;cursor:pointer;position:relative;${s.value&&s.target==="cancelButton"?"opacity:.6;":""}`,onclick:()=>{z(e,"cancelButton")}},[s.value&&s.target==="cancelButton"?i("span",{style:`width: 10px;height:10px;margin-right:5px;border:1px solid #666;border-radius:50%;border-top:1px solid transparent; transform:rotate(${h.value}deg);`}):null,i("div",{style:"min-width:44px;text-align:center;"},e.cancelButton.text||"cancel")]),i("div",{class:"modal-vue3-footer-ok",style:`height:30px;padding: 0 8px;border-radius:2px;display:flex;justify-content:center;align-items:center;background-color:#4395ff;color:#fff;cursor:pointer;position:relative;${s.value&&s.target==="okButton"?"opacity:.6;":""}`,onclick:()=>{z(e,"okButton")}},[s.value&&s.target==="okButton"?i("span",{style:`width: 10px;height:10px;margin-right:5px;border:1px solid #fff;border-radius:50%;border-top:1px solid transparent; transform:rotate(${h.value}deg);`}):null,i("div",{style:"min-width:44px;text-align:center;"},e.okButton.text||"ok")])]):null])])]):null}}}}),q=e=>(oe("data-v-d8faac14"),e=e(),ae(),e),se={class:"formulario"},re={class:"filters"},de={class:"excel-table"},ce=q(()=>l("thead",null,[l("tr",null,[l("th",null,"Numero Factura"),l("th",null,"Cliente"),l("th",null,"Total"),l("th",null,"Fecha"),l("th",null,"Usuario"),l("th",null,"Ver Detalle")])],-1)),ue={class:"excel-cell"},pe={class:"excel-cell"},ve={class:"excel-cell"},me={class:"excel-cell"},fe={class:"excel-cell"},ge={class:"excel-cell"},he=["onClick"],xe={key:0,class:"card-popup"},be={class:"formulario"},_e={class:"excel-cell"},ye={class:"excel-table"},ke=q(()=>l("thead",null,[l("tr",null,[l("th",null,"Codigo"),l("th",null,"Producto"),l("th",null,"Cantidad"),l("th",null,"Precio Unitario"),l("th",null,"SubTotal")])],-1)),we={class:"excel-cell"},Se={class:"excel-cell"},$e={class:"excel-cell"},Be={class:"excel-cell"},Ie={class:"excel-cell"},Ce={class:"white-text"},Ve={__name:"InvoiceView",setup(e){const y=C([]);let v=_(!1);const m=_({idInvoice:0,date:"",total:0}),r=_(""),$=_("");Q(()=>{const f=H.getUserLogged();if(f.id=="")return Z.push("/");H.getAllInvoicesForUser(f).then(a=>{switch(a.status){case 200:a.data.forEach(n=>{n.date=g(n.date),n.total=n.total==null?0:n.total,y.push(n)})}}).catch(a=>{console.log(a.message)})});const N=()=>{console.log("Filtros aplicados:",r.value,$.value)},V=f=>{m.value=y.find(a=>f===a.idInvoice),v.value=!0},g=f=>{const a=new Date(f),n=String(a.getDate()).padStart(2,"0"),h=String(a.getMonth()+1).padStart(2,"0"),x=a.getFullYear(),o=String(a.getHours()).padStart(2,"0"),F=String(a.getMinutes()).padStart(2,"0"),s=String(a.getSeconds()).padStart(2,"0");return`${n}/${h}/${x} ${o}:${F}:${s}`};return(f,a)=>{const n=j("el-input"),h=j("el-date-picker"),x=j("el-button");return w(),S("div",null,[I(ne),l("div",se,[l("div",re,[I(n,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=o=>r.value=o),placeholder:"Filtrar por Cliente"},null,8,["modelValue"]),I(h,{modelValue:$.value,"onUpdate:modelValue":a[1]||(a[1]=o=>$.value=o),type:"date",placeholder:"Filtrar por Fecha"},null,8,["modelValue"]),I(x,{onClick:N},{default:A(()=>[te("Aplicar Filtros")]),_:1})]),l("table",de,[ce,l("tbody",null,[(w(!0),S(O,null,P(y,o=>(w(),S("tr",{key:o.idInvoice,class:"excel-row"},[l("td",ue,d(o.idInvoice),1),l("td",pe,d(o.customer.customerName),1),l("td",ve,d(o.total),1),l("td",me,d(o.date),1),l("td",fe,d(o.user.userName),1),l("td",ge,[l("button",{onClick:F=>V(o.idInvoice)},"Ver",8,he)])]))),128))])])]),I(L(ie),{visible:L(v),"onUpdate:visible":a[2]||(a[2]=o=>ee(v)?v.value=o:v=o),title:"FACTURA NÂ°: "+m.value.idInvoice+"- FECHA: "+m.value.date},{default:A(()=>[L(v)?(w(),S("div",xe,[l("p",null,"Cliente Nombre: "+d(m.value.customer.customerName),1),l("div",be,[l("div",_e,[l("table",ye,[ke,l("tbody",null,[(w(!0),S(O,null,P(m.value.listItemsInvoice,o=>(w(),S("tr",{key:o.idItemInvoice,class:"excel-row"},[l("td",we,d(o.idItemInvoice),1),l("td",Se,d(o.name),1),l("td",$e,d(o.quantity),1),l("td",Be,d(o.unitPrice),1),l("td",Ie,d(o.unitPrice*o.quantity),1)]))),128))])]),l("p",Ce,"TOTAL: "+d(m.value.total),1)])])])):le("",!0)]),_:1},8,["visible","title"])])}}},Te=K(Ve,[["__scopeId","data-v-d8faac14"]]);export{Te as default};
