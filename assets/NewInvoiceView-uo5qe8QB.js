import{_ as V,r as g,a as _,o as k,b as A,c as b,d as l,e as c,f as B,g as e,w as h,v as I,F as w,h as C,i as P,t as f,p as U,j as F}from"./index-nyPrgSJc.js";import{N as E}from"./NavBar-2O6uRFhp.js";const n=i=>(U("data-v-ec469f5a"),i=i(),F(),i),M={class:"formulario"},q={class:"campo"},z=n(()=>e("label",{for:"cliente"},"Cliente:",-1)),D=["value"],J={class:"campo"},O=n(()=>e("label",{for:"articulo"},"Artículo:",-1)),T=["value"],j={class:"campo"},L=n(()=>e("label",{for:"cantidad"},"Cantidad:",-1)),G=n(()=>e("hr",null,null,-1)),H={class:"excel-table"},K=n(()=>e("thead",null,[e("tr",null,[e("th",null,"Artículo"),e("th",null,"Cantidad"),e("th",null,"Borrar")])],-1)),Q={class:"excel-cell"},R={class:"excel-cell"},W=n(()=>e("td",null,[e("button",null,"Borrar")],-1)),X={class:"campo"},Y=n(()=>e("label",{for:"total"},"Total:",-1)),Z={__name:"NewInvoiceView",setup(i){const d=g([]),v=g([]),r=_(""),u=_(""),s=_("1"),m=g([]),p=_(0);k(()=>{if(JSON.parse(localStorage.getItem("user")).id=="")return A.push("/");b.getAllCustomers().then(t=>{switch(t.status){case 200:t.data.forEach(o=>{d.push(o)})}}).catch(t=>{console.log(t.message)}),b.getAllProducts().then(t=>{switch(t.status){case 200:t.data.forEach(o=>{v.push(o)})}}).catch(t=>{console.log(t.message)})});const S=()=>{if(u&&s.value>0){const a=v.find(o=>o.idProduct===u.value),t={product:a,name:a.name,unitPrice:a.unitPrice,cost:a.cost,quantity:s.value};p.value+=a.unitPrice*s.value,m.push(t),u.value="",s.value=1}else alert("Por favor, complete todos los campos antes de agregar el producto.")},x=()=>{if(!r.value){alert("Por favor, seleccione un cliente.");return}const a={user:{idUser:JSON.parse(localStorage.getItem("user")).id},customer:{idCustomer:d.find(t=>t.idCustomer===r.value).idCustomer},listItemsInvoice:m,total:p.value};b.newInvoice(a).then(t=>{switch(t.status){case 200:alert("Factura guardada con exito"),N()}}).catch(t=>{console.log(t.message)}),console.log("Productos finales:",a)},N=()=>{d.value="",v.value="",r.value="",u.value="",s.value="1",m.length=0};return(a,t)=>(l(),c("div",null,[B(E),e("div",M,[e("div",q,[z,h(e("select",{id:"cliente","onUpdate:modelValue":t[0]||(t[0]=o=>r.value=o)},[(l(!0),c(w,null,C(d,o=>(l(),c("option",{key:o.idCustomer,value:o.idCustomer},f(o.customerName),9,D))),128))],512),[[I,r.value]])]),e("div",J,[O,h(e("select",{id:"articulo","onUpdate:modelValue":t[1]||(t[1]=o=>u.value=o)},[(l(!0),c(w,null,C(v,o=>(l(),c("option",{key:o.idProduct,value:o.idProduct},f(o.name),9,T))),128))],512),[[I,u.value]])]),e("div",j,[L,h(e("input",{id:"cantidad","onUpdate:modelValue":t[2]||(t[2]=o=>s.value=o),type:"number",min:"1"},null,512),[[P,s.value,void 0,{number:!0}]])]),e("button",{onClick:S},"Agregar"),G,e("table",H,[K,e("tbody",null,[(l(!0),c(w,null,C(m,(o,y)=>(l(),c("tr",{key:y,class:"excel-row"},[e("td",Q,f(o.product.name),1),e("td",R,f(o.quantity),1),W]))),128))])]),e("div",X,[Y,h(e("input",{id:"total","onUpdate:modelValue":t[3]||(t[3]=o=>p.value=o),disabled:""},null,512),[[P,p.value]])]),e("button",{onClick:x},"Finalizar")])]))}},te=V(Z,[["__scopeId","data-v-ec469f5a"]]);export{te as default};
